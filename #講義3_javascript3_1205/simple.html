<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<link rel="stylesheet" href="css/fukushi.css">
<title>ç­‹ãƒˆãƒ¬Chatã‚¢ãƒ—ãƒª</title>
</head>
<body>


<!-- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è¡¨ç¤ºç”»é¢ -->
<!-- <h1>ğŸ’ªã•ãã€ã¿ã‚“ãªã‚‚ã£ã¨ãŠäº’ã„ã‚’è®ƒãˆã‚ˆã†ğŸ’ª</h1> -->
<!-- <p class="tittle">ğŸ’ªã•ãã€ã¿ã‚“ãªã‚‚ã£ã¨ãŠäº’ã„ã‚’è®ƒãˆã‚ˆã†ğŸ’ª</p> -->
<div class="tittle">
    ğŸ’ªã•ãã€ã¿ã‚“ãªä»Šæ—¥ã‚‚é›ãˆãŸãŠäº’ã„ã‚’è®ƒãˆã‚ˆã†ğŸ’ª
</div>
<div>
    <ul>
        <li class="imgs" data-img="0"><img src="imgs/buke.png" width="200"></li>
        <li class="imgs" data-img="1"><img src="imgs/tuku.jpg" width="200"></li>
        <li class="imgs" data-img="2"><img src="imgs/caram.png" width="200"></li>
    </ul>
    <div>
        ç­‹è‚‰åï¼š<input type="text" id="uname">
    </div>
    <div>
        <textarea id="text" cols="30" rows="10">ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°å†…å®¹</textarea>
        <button id="send">é€ä¿¡</button>
    </div>
    <div id="output" style="height:300px; width: 700px; overflow:auto;"></div>
</div>
<!--/ ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è¡¨ç¤ºç”»é¢ -->


<!-- JQuery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<!-- JQuery -->


<!--** ä»¥ä¸‹Firebase **-->
<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/8.1.2/firebase.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->

<script>
    // Your web app's Firebase configuration
        var firebaseConfig = {
        apiKey: "AIzaSyCr-WyBE5Ti2RQWKIyfW8Usuu0jerVghE8",
        authDomain: "unit1-1f516.firebaseapp.com",
        projectId: "unit1-1f516",
        storageBucket: "unit1-1f516.appspot.com",
        messagingSenderId: "376770248075",
        appId: "1:376770248075:web:67571b165835f30e2c038e"
        };
    // Initialize Firebase
        firebase.initializeApp(firebaseConfig);

        const ref = firebase.database().ref();
    // ref()ã®ä¸­ã«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã‚’æ›¸ãã¨ãã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã§ä¿å­˜ã§ãã‚‹



    // ã‚¢ã‚¤ã‚³ãƒ³å‡¦ç†
    let d=0;
    const img = ["buke.png","tuku.jpg","caram.png"];
    $(".imgs").on("click",function(){
        d = $(this).attr("data-img"); //attrã‚’fttrã£ã¦æ‰“ã¡é–“é•ã„(T_T)
    });



    // é€ä¿¡ã‚¤ãƒ™ãƒ³ãƒˆ
        $("#send").on("click", function(){
            // æ—¥æ™‚ã®å–å¾—
                let date = new Date();
                function sampleDate(date, format) {
                    format = format.replace(/YYYY/, date.getFullYear());
                    format = format.replace(/MM/, date.getMonth() + 1);
                    format = format.replace(/DD/, date.getDate());
                    format = format.replace(/h/g, date.getHours());
                    format = format.replace(/m/g, date.getMinutes());
                    format = format.replace(/s/g, date.getSeconds());
                    return format;
                }
            let postday = sampleDate(date, 'YYYY-MM-DD-h-m-s');

                const uname = $("#uname").val();
                const text  = $("#text").val();
                const msg   = {
                uname: uname,   //é€ä¿¡å:å€¤
                text: text,     //é€ä¿¡å:å€¤
                date: postday,
                icon: d
                };
                ref.push(msg);    //ã‚µãƒ¼ãƒãƒ¼ã«Push
        });



    // å—ä¿¡ã‚¤ãƒ™ãƒ³ãƒˆ
        ref.on("child_added",function(data){
            const v = data.val();
            const k = data.key; //æ›´æ–°ã¨å‰Šé™¤ã«å¿…è¦ã‚‰ã—ã„
            const h = '<p><img src="imgs/'+img[v.icon]+'" width="50">'+v.date+'<br>'+v.uname+'<br>'+v.text+'</p>'; 
            //'<p>'ã®>ã®ã™ãå¾Œã‚ã«å…¥ã‚Œãªã„ã¨ãƒ€ãƒ¡ã€‚>'ã®å¾Œã«å…¥ã‚Œã¦ãŸ
            $("#output").append(h);
            const tdiv = document.getElementById("output"); //ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä¸‹éƒ¨ã¸ç§»å‹•
            tdiv.scrollTop = tdiv.scrollHeight;
        });



    // // Enterã§é€ä¿¡ã‚¤ãƒ™ãƒ³ãƒˆ ä½¿ã„ã¥ã‚‰ã„ã®ã§ä¸€æ—¦å‰Šé™¤
    //     $("#text").on("keydown",function(e){
    //         // æ—¥æ™‚ã®å–å¾—
    //         let date = new Date();
    //             function sampleDate(date, format) {
    //                 format = format.replace(/YYYY/, date.getFullYear());
    //                 format = format.replace(/MM/, date.getMonth() + 1);
    //                 format = format.replace(/DD/, date.getDate());
    //                 format = format.replace(/h/g, date.getHours());
    //                 format = format.replace(/m/g, date.getMinutes());
    //                 format = format.replace(/s/g, date.getSeconds());
    //                 return format;
    //             }
    //         let postday = sampleDate(date, 'YYYY-MM-DD-h-m-s');

    //         console.log(e.keyCode);
    //         if(e.keyCode==13){
    //         const uname = $("#uname").val();
    //         const text  = $("#text").val();
    //         const msg   = {
    //         uname: uname,   //é€ä¿¡å:å€¤
    //         text: text,     //é€ä¿¡å:å€¤
    //         date: postday,
    //         icon: d
    //         };
    //         ref.push(msg);    //ã‚µãƒ¼ãƒãƒ¼ã«Push
    //         }
    //     });




</script>



</body>
</html>
































